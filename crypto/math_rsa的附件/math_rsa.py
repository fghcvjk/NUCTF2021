from gmpy2 import *
from Crypto.Util.number import *
from secret import FLAG,x,y
import sympy
import pylab

def calc():
	y1 = sympy.diff(y,x)
	y2 = sympy.diff(y1,x)
	v1,v2,v3 = [],[],[]
	for i in FLAG:
		v1.append(y.subs('x',i)) 
	print('v1 =',v1[:34])
	for i in v1:
		v2.append(y1.subs('x',i))
	print('v2 =',v2[:2])
	for i in v2:
		v3.append(y2.subs('x',i))
	print('v3 =',v3[:2])
	pylab.plot(v2,v3)
	pylab.show()

def rsam():
	m = bytes_to_long(FLAG)
	while True:
		try:
			p = getPrime(768)
			q = getPrime(768)
			n = p*q
			e = 3
			phi = (p-1)*(q-1)
			d = invert(e,phi)
			c = pow(m,e,n)
			print('n =',n)
			print('e =',e)
			print('c =',c)
			break
		except:
			pass

def main():
	rsam()
	calc()
if __name__ == '__main__':
	main()

'''
n = 2260375559104345425590426977960386256287009777233277062625487017885931446911942921201492850167115455071935831283269948569220356763988762825230315520633702443866690239945242948370781975714325308306543337600783340792458991506685843729962897796956171467876531084194426101796617903015810156717396227079274786269217370618477266867389155551378798713259843750289765858717627925689021561352438080039804957145513478767641674644346609224034274906228784593435462413278410143
e = 3
c = 1683427726786225271109289808778075351906457081282891335272956455076290407290946927840180672315908981114229434899424882579823897506730018911375238394076293908946844135295984336122170362703361647325169444373502665686779049846717305377396296752361918921007897449738856962248716579014267597667341690453460130215215256776249910808564677407383996700090361822122676428069577517468851642648993930679875398568383201032360229083338487146673018350740571719960730053254352184
v1 = [3149069, 2271689, 2337632, 3068562, 67697, 2337632, 3068562, 67697, 2143547, 2543093, 1844472, 2206998, 67697, 1844472, 2686547, 2020317, 67697, 3149069, 2271689, 2081324, 67697, 2143547, 2543093, 1844472, 2206998, 67697, 2337632, 3068562, 67697, 2143547, 2543093, 1844472, 2206998, 3752378]
v2 = [59499825996845, 30963434563085]
v3 = [713997911962144, 371561214757024]
'''